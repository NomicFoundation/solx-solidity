// RUN: sol-opt -convert-sol-to-std=target=evm %s | FileCheck %s

module {
  sol.func @f() {
    sol.return
  }

  sol.func @while(%cond : i1) {
    sol.while {
      sol.condition %cond
    } do {
      sol.call @f() : () -> ()
      sol.yield
    }
    sol.return
  }

  sol.func @do_while(%cond : i1) {
    sol.do {
      sol.call @f() : () -> ()
      sol.yield
    } while {
      sol.condition %cond
    }
    sol.return
  }
}

// NOTE: Assertions have been autogenerated by test/updFileCheckTest.py
// CHECK: module {
// CHECK-NEXT:   func.func @f() attributes {llvm.linkage = #llvm.linkage<private>, passthrough = ["nofree", "null_pointer_is_valid"]} {
// CHECK-NEXT:     return
// CHECK-NEXT:   }
// CHECK-NEXT:   func.func @while(%arg0: i1) attributes {llvm.linkage = #llvm.linkage<private>, passthrough = ["nofree", "null_pointer_is_valid"]} {
// CHECK-NEXT:     cf.br ^bb1
// CHECK-NEXT:   ^bb1:  // 2 preds: ^bb0, ^bb2
// CHECK-NEXT:     cf.cond_br %arg0, ^bb2, ^bb3
// CHECK-NEXT:   ^bb2:  // pred: ^bb1
// CHECK-NEXT:     call @f() : () -> ()
// CHECK-NEXT:     cf.br ^bb1
// CHECK-NEXT:   ^bb3:  // pred: ^bb1
// CHECK-NEXT:     return
// CHECK-NEXT:   }
// CHECK-NEXT:   func.func @do_while(%arg0: i1) attributes {llvm.linkage = #llvm.linkage<private>, passthrough = ["nofree", "null_pointer_is_valid"]} {
// CHECK-NEXT:     cf.br ^bb2
// CHECK-NEXT:   ^bb1:  // pred: ^bb2
// CHECK-NEXT:     cf.cond_br %arg0, ^bb2, ^bb3
// CHECK-NEXT:   ^bb2:  // 2 preds: ^bb0, ^bb1
// CHECK-NEXT:     call @f() : () -> ()
// CHECK-NEXT:     cf.br ^bb1
// CHECK-NEXT:   ^bb3:  // pred: ^bb1
// CHECK-NEXT:     return
// CHECK-NEXT:   }
// CHECK-NEXT: }
// CHECK-EMPTY:
// CHECK-EMPTY:
